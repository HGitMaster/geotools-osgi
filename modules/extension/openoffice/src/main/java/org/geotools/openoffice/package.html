<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<HTML>
  <HEAD>
    <TITLE>package org.geotools.openoffice</TITLE>
  </HEAD>
  <BODY>
    Provides Geotools functionalities as add-ins for <A HREF="http://www.openoffice.org">OpenOffice</A>.

    <H2>Compilation and deployment instruction</H2>
    <P ALIGN="justify">All {@code XFoo} Java interfaces are generated from IDL files with the same
    name. As long as {@code XFoo} Java/IDL interfaces are not modified, there is no need for the
    OpenOffice SDK. But if any {@code XFoo} interface is modified, then steps 1 to 3 below must
    be done. Steps 5 to 7 are performed by Maven, but are cited here for completness. Step 8 must
    be executed on the client machine (users can also use the "<CITE>Tools / Package manager</CITE>"
    menu from OpenOffice GUI).</P>

    <TABLE><TR VALIGN="top"><TD>
      <TABLE><TR><TD>
        <TABLE BORDER='1'>
          <TR><TH>Tool</TH>                   <TH NOWRAP>Provided with</TH></TR>
          <TR><TD><CODE>idlc</CODE></TD>      <TD NOWRAP>OpenOffice SDK</TD></TR>
          <TR><TD><CODE>regmerge</CODE></TD>  <TD NOWRAP>OpenOffice SDK</TD></TR>
          <TR><TD><CODE>javamaker</CODE></TD> <TD NOWRAP>OpenOffice SDK</TD></TR>
          <TR><TD><CODE>javap</CODE></TD>     <TD NOWRAP>Java SDK</TD></TR>
          <TR><TD><CODE>javac</CODE></TD>     <TD NOWRAP>Java SDK</TD></TR>
          <TR><TD><CODE>jar</CODE></TD>       <TD NOWRAP>Java SDK</TD></TR>
          <TR><TD><CODE>zip</CODE></TD>       <TD NOWRAP>Unix distribution</TD></TR>
          <TR><TD><CODE>unopkg</CODE></TD>    <TD NOWRAP>OpenOffice suite</TD></TR>
        </TABLE>
        </TD></TR><TR><TD>
        <P>&nbsp;</P>
        <TABLE>
          <TR><TH>Required OOo JARs</TH></TR>
          <TR><TD><CODE>ridl.jar</CODE></TD></TR>
          <TR><TD><CODE>unoil.jar</CODE></TD></TR>
          <TR><TD><CODE>jurt.jar</CODE></TD></TR>
          <TR><TD><CODE>juh.jar</CODE></TD></TR>
        </TABLE>
      </TABLE>
      </TD><TD><OL>
        <LI><P>Compiles the UNO {@code .urd} binary file</P>
        <BLOCKQUOTE><CODE>
        idlc -C -cid -w -I $OO_SDK_HOME/idl org/geotools/openoffice/XReferencing.idl
        </CODE></BLOCKQUOTE></LI>

        <LI><P>Compiles the UNO {@code .rdb} registry file</P>
        <BLOCKQUOTE><CODE>
        regmerge geotools.rdb /UCR org/geotools/openoffice/XReferencing.urd
        </CODE></BLOCKQUOTE></LI>

        <LI><P>Creates the {@code .class} file for Java interfaces</P>
        <BLOCKQUOTE><CODE>
        javamaker -BUCR -nD -Torg.geotools.openoffice.XReferencing geotools.rdb $OFFICE_PROGRAM_PATH/types.rdb
        </CODE></BLOCKQUOTE></LI>

        <LI><P>Derives a {@code .java} source from the {@code .class} file</P>
        <BLOCKQUOTE><CODE>
        javap org.geotools.openoffice.XReferencing
        </CODE></BLOCKQUOTE></LI>

        <HR>

        <LI><P>Compiles {@code .java} source files</P>
        <BLOCKQUOTE><CODE>
        javac org/geotools/openoffice/*.java
        </CODE></BLOCKQUOTE></LI>

        <LI><P>Creates the {@code .jar} file</P>
        <BLOCKQUOTE><CODE>
        jar -cfm0 openoffice-2.3-SNAPSHOT.jar META-INF/MANIFEST.MF org/geotools/openoffice/*.class
        </CODE></BLOCKQUOTE></LI>

        <LI><P>Creates the {@code .pkg} file</P>
        <BLOCKQUOTE><CODE>
        zip -9 geotools.uno.pkg geotools.rdb openoffice-2.3-SNAPSHOT.jar META-INF/manifest.xml
        </CODE></BLOCKQUOTE></LI>

        <HR>

        <LI><P>Register the component to OpenOffice</P>
        <BLOCKQUOTE><CODE>
        unopkg add geotools.uno.pkg
        </CODE></BLOCKQUOTE></LI>
      </OL></TD></TR>
    </TABLE>
  </BODY>
</HTML>
